<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>convert.py</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>convert.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <h3><span id="imports" href="imports"> Imports </span></h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>  <span class="c1"># for calculations</span>
<span class="kn">import</span> <span class="nn">os</span>  <span class="c1"># for paths and directories</span>
<span class="kn">import</span> <span class="nn">re</span>  <span class="c1"># for regular expressions</span>
<span class="kn">import</span> <span class="nn">time</span>  <span class="c1"># to measure execution time</span>
<span class="kn">import</span> <span class="nn">zipfile</span>  <span class="c1"># to handle .zip files (.qua and .osz)</span>

<span class="kn">import</span> <span class="nn">yaml</span>  <span class="c1"># to parse .yaml files (.qua)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <h3><span id="constants" href="constants"> Constants </span></h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">REGEX_ILLEGAL_CHARACTERS</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[&lt;&gt;:</span><span class="se">\&quot;</span><span class="s2">/</span><span class="se">\\</span><span class="s2">|\?\*]&quot;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <p>For attributes that exist in both games but are named differently
QuaverAttribute: osuAttribute</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">RENAMES</span> <span class="o">=</span> <span class="p">{</span>

    <span class="s2">&quot;general&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;AudioFile&quot;</span><span class="p">:</span> <span class="s2">&quot;AudioFilename&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SongPreviewTime&quot;</span><span class="p">:</span> <span class="s2">&quot;PreviewTime&quot;</span>
    <span class="p">},</span>

    <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;DifficultyName&quot;</span><span class="p">:</span> <span class="s2">&quot;Version&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SongPreviewTime&quot;</span><span class="p">:</span> <span class="s2">&quot;PreviewTime&quot;</span>
    <span class="p">},</span>

<span class="p">}</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p>For attributes that should be left the way they are
QuaverAttribute: osuAttribute</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">DEFAULT_VALUES</span> <span class="o">=</span> <span class="p">{</span>

    <span class="s2">&quot;general&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;AudioLeadIn&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;Countdown&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;StackLeniency&quot;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>
        <span class="s2">&quot;Mode&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;LetterboxInBreaks&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;SpecialStyle&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;WidescreenStoryboard&quot;</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">},</span>

    <span class="s2">&quot;editor&quot;</span><span class="p">:</span> <span class="p">{</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>If bookmarks were to be set to None,
it would print out &ldquo;None&rdquo; when casted to a string</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="s2">&quot;Bookmarks&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;DistanceSpacing&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
        <span class="s2">&quot;BeatDivisor&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="s2">&quot;GridSize&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="s2">&quot;TimelineZoom&quot;</span><span class="p">:</span> <span class="mf">2.5</span>
    <span class="p">},</span>

    <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;BeatmapID&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;BeatmapSetID&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span>
    <span class="p">},</span>

    <span class="s2">&quot;difficulty&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;ApproachRate&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
        <span class="s2">&quot;SliderMultiplier&quot;</span><span class="p">:</span> <span class="mf">1.4</span><span class="p">,</span>
        <span class="s2">&quot;SliderTickRate&quot;</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">}</span>
<span class="p">}</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <h3><span id="functions" href="functions"> Functions </span></h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>Parses the .qua (.yaml) file into an object using PyYaml</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">loadQua</span><span class="p">(</span><span class="n">fileContent</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">qua</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">fileContent</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">qua</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <p>Currently unused
Cleans the path by removing illegal characters and replacing spaces with underscores</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">cleanPath</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">path</span> <span class="o">=</span> <span class="n">REGEX_ILLEGAL_CHARACTERS</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">path</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <p>Generates the [General] section of the .osu</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">convertGeneral</span><span class="p">(</span><span class="n">qua</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <p>Currently generates following attributes:
    AudioFilename, AudioLeadIn,
    PreviewTime, SampleSet,
    StackLeniency, Mode,
    LetterboxInBreaks, SpecialStyle,
    WidescreenStoryboard</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;[General]&quot;</span><span class="p">]</span>
    <span class="n">generalRenames</span> <span class="o">=</span> <span class="n">RENAMES</span><span class="p">[</span><span class="s2">&quot;general&quot;</span><span class="p">]</span>
    <span class="n">generalDefaultValues</span> <span class="o">=</span> <span class="n">DEFAULT_VALUES</span><span class="p">[</span><span class="s2">&quot;general&quot;</span><span class="p">]</span>

    <span class="n">sampleSet</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;sampleSet&quot;</span><span class="p">]</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SampleSet: </span><span class="si">{sampleSet}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">RENAMES</span><span class="p">[</span><span class="s2">&quot;general&quot;</span><span class="p">]:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{generalRenames[element]}</span><span class="s2">: </span><span class="si">{qua[element]}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="n">generalDefaultValues</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{attribute}</span><span class="s2">: </span><span class="si">{generalDefaultValues[attribute]}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <p>Generates the [Editor] section of the .osu</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">convertEditor</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <p>Currently generates following attributes:
    Bookmarks, DistanceSpacing,
    BeatDivisor, GridSize, TimelineZoom</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;[Editor]&quot;</span><span class="p">]</span>
    <span class="n">editorDefaultValues</span> <span class="o">=</span> <span class="n">DEFAULT_VALUES</span><span class="p">[</span><span class="s2">&quot;editor&quot;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="n">editorDefaultValues</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{attribute}</span><span class="s2">: </span><span class="si">{editorDefaultValues[attribute]}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <p>Generates the [Metadata] section of the .osu</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">convertMetadata</span><span class="p">(</span><span class="n">qua</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <p>Currently generates following attributes:
    AudioFile, Artist, ArtistUnicode, Title,
    TitleUnicode, Source, Creator, Tags,
    BeatmapID, BeatmapSetID</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;[Metadata]&quot;</span><span class="p">]</span>
    <span class="n">metadataRenames</span> <span class="o">=</span> <span class="n">RENAMES</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span>
    <span class="n">metadataDefaultValues</span> <span class="o">=</span> <span class="n">DEFAULT_VALUES</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">qua</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">element</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;AudioFile&quot;</span><span class="p">,</span> <span class="s2">&quot;Artist&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="s2">&quot;Source&quot;</span><span class="p">,</span> <span class="s2">&quot;Creator&quot;</span><span class="p">]:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{element}</span><span class="s2">:</span><span class="si">{qua[element]}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">element</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Artist&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">]:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{element}</span><span class="s2">Unicode:</span><span class="si">{qua[element]}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">metadataRenames</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{metadataRenames[element]}</span><span class="s2">:</span><span class="si">{qua[element]}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">element</span> <span class="o">==</span> <span class="s2">&quot;Tags&quot;</span><span class="p">:</span>
            <span class="n">tags</span> <span class="o">=</span> <span class="n">qua</span><span class="p">[</span><span class="s2">&quot;Tags&quot;</span><span class="p">]</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tags:Quaver </span><span class="si">{tags}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="n">metadataDefaultValues</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{attribute}</span><span class="s2">:</span><span class="si">{metadataDefaultValues[attribute]}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>Generates the [Difficulty] section of the .osu</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">convertDifficulty</span><span class="p">(</span><span class="n">qua</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <p>Currently generates following attributes:
    HPDrainRate, CircleSize,
    OverallDifficulty, ApproachRate,
    SliderMultiplier, SliderTickrate</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;[Difficulty]&quot;</span><span class="p">]</span>
    <span class="n">difficultyDefaultValues</span> <span class="o">=</span> <span class="n">DEFAULT_VALUES</span><span class="p">[</span><span class="s2">&quot;difficulty&quot;</span><span class="p">]</span>

    <span class="n">keyCount</span> <span class="o">=</span> <span class="n">qua</span><span class="p">[</span><span class="s2">&quot;Mode&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">od</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;od&quot;</span><span class="p">]</span>
    <span class="n">hp</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;hp&quot;</span><span class="p">]</span>

    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;OverallDifficulty: </span><span class="si">{od}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CircleSize: </span><span class="si">{keyCount}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;HPDrainRate: </span><span class="si">{hp}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="n">difficultyDefaultValues</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{attribute}</span><span class="s2">: </span><span class="si">{difficultyDefaultValues[attribute]}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <p>Generates the [Events] section of the .osu (only background)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">convertEvents</span><span class="p">(</span><span class="n">qua</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <p>Background syntax: 0,0,filename,0,0</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;[Events]&quot;</span><span class="p">]</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;0,0,&quot;</span><span class="si">{qua[&quot;BackgroundFile&quot;]}</span><span class="s1">&quot;,0,0&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      <p>Generates the [TimingPoints] section of the .osu</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">convertTimingPoints</span><span class="p">(</span><span class="n">qua</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <p>Structure of a timing point:
    [time,beatLength,meter,sampleSet,sampleIndex,volume,uninherited,effects]</p>
<pre><code>time (int)
    Start time of the timing section, in milliseconds from the
    beginning of the beatmap's audio. The end of the timing section
    is the next timing point's time (or never, if this is the
    last timing point).

beatLength : float
    - For uninherited timing points, the duration of a beat, in
        milliseconds.
    - For inherited timing points, a negative inverse slider
        velocity multiplier, as a percentage. For example, -50 would
        make all sliders in this timing section twice
        as fast as SliderMultiplier.

meter (int)
    Amount of beats in a measure. Inherited timing points ignore
    this property.

sampleSet (int)
    Default sample set for hit objects (0 = beatmap default,
    1 = normal, 2 = soft, 3 = drum).

sampleIndex (int)
    Custom sample index for hit objects. 0 indicates osu!'s default
    hit sounds.

volume (int)
    Volume percentage for hit objects.

uninherited (0 or 1)
    Whether or not the timing point is uninherited.

effects (int:int:...)
    Bit flags that give the timing point extra effects.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;[TimingPoints]&quot;</span><span class="p">]</span>
    <span class="n">hitSoundVolume</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;hitSoundVolume&quot;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">timingPoint</span> <span class="ow">in</span> <span class="n">qua</span><span class="p">[</span><span class="s2">&quot;TimingPoints&quot;</span><span class="p">]:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <p>If any value is 0 then Quaver doesn&rsquo;t print it in the qua</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">startTime</span> <span class="o">=</span> <span class="n">timingPoint</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;StartTime&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">bpm</span> <span class="o">=</span> <span class="n">timingPoint</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Bpm&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">bpm</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># 0.0x bpm or negative bpm</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      <p>substituting with very low bpm value (0.000006 BPM)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">msPerBeat</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10e10</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msPerBeat</span> <span class="o">=</span> <span class="mi">60000</span> <span class="o">/</span> <span class="n">bpm</span>

        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{startTime}</span><span class="s2">,</span><span class="si">{msPerBeat}</span><span class="s2">,4,0,0,</span><span class="si">{hitSoundVolume}</span><span class="s2">,1,0&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">sv</span> <span class="ow">in</span> <span class="n">qua</span><span class="p">[</span><span class="s2">&quot;SliderVelocities&quot;</span><span class="p">]:</span>
        <span class="n">startTime</span> <span class="o">=</span> <span class="n">sv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;StartTime&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">multiplier</span> <span class="o">=</span> <span class="n">sv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Multiplier&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">multiplier</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># 0.0x sv or negative sv</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <p>substituting with very low sv value (0.00000001â€¬x)
osu! clamps values between 0.01x - 10x so this wouldn&rsquo;t
have been necessary actually</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">svValue</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10e10</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">svValue</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100</span> <span class="o">/</span> <span class="n">multiplier</span>

        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{startTime}</span><span class="s2">,</span><span class="si">{svValue}</span><span class="s2">,0,0,0,</span><span class="si">{hitSoundVolume}</span><span class="s2">,0&quot;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      <p>osu doesnt care if the section is sorted
chronologically or not so im not doing it</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>


<span class="n">hitSoundsDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Normal&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;Whistle&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;Finish&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s2">&quot;Clap&quot;</span><span class="p">:</span> <span class="mi">8</span>
<span class="p">}</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-27'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-27'>#</a>
      </div>
      <p>Generates the [TimingPoints] section of the .osu</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">convertHitObjects</span><span class="p">(</span><span class="n">qua</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-28'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-28'>#</a>
      </div>
      <ul>
<li>
<p>Types:
    1 &lt;&lt; 0 : Hit circle (normal note in osu!mania)
    1 &lt;&lt; 1 : Slider (unused in osu!mania)
    1 &lt;&lt; 3 : Spinner (unused in osu!mania)
    1 &lt;&lt; 7 : osu!mania hold (commonly referred to as long note or LN)</p>
</li>
<li>
<p>Structure of a normal hit object:</p>
<ul>
<li>
<p>[x,y,time,type,hitSound,objectParams,hitSample]</p>
</li>
<li>
<p>x (int)
    Determines the index of the column that the note will be in.
    It is computed by floor(x * columnCount / 512) and
    clamped between 0 and columnCount - 1.</p>
</li>
<li>
<p>y (int)
    Unused in osu!mania, defaults to 192</p>
</li>
<li>
<p>time (int)
    Time when the object is to be hit, in milliseconds from
    the beginning of the beatmap&rsquo;s audio.</p>
</li>
<li>
<p>type (int)
    Bit flags indicating the type of the object.</p>
</li>
</ul>
</li>
<li>
<p>hitSound (int,int,&hellip;)
        Extra parameters specific to the object&rsquo;s type.</p>
<ul>
<li>
<p>objectParams
    Extra parameters specific to the object&rsquo;s type.</p>
</li>
<li>
<p>hitSample (int)
    bitwise flag</p>
</li>
</ul>
</li>
<li>
<p>Structure of a LN:</p>
<ul>
<li>
<p>[x,y,time,type,hitSound,endTime:hitSample]</p>
</li>
<li>
<p>endTime (int)
    End time of the hold, in milliseconds from the
    beginning of the beatmap&rsquo;s audio.</p>
</li>
</ul>
</li>
</ul>
<p>TODO finish docs</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;[HitObjects]&quot;</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-29'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-29'>#</a>
      </div>
      <p>Mode is provided either as &ldquo;Keys4&rdquo; or &ldquo;Keys7&rdquo; so this
extracts the number</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">numberOfCcolumns</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">qua</span><span class="p">[</span><span class="s2">&quot;Mode&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">:])</span>

    <span class="k">for</span> <span class="n">hitObject</span> <span class="ow">in</span> <span class="n">qua</span><span class="p">[</span><span class="s2">&quot;HitObjects&quot;</span><span class="p">]:</span>

        <span class="n">startTime</span> <span class="o">=</span> <span class="n">hitObject</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;StartTime&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">lane</span> <span class="o">=</span> <span class="n">hitObject</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Lane&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-30'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-30'>#</a>
      </div>
      <p>osu uses the x coordinate to determine the
position, the max width of the osu playfield is 512</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">xPos</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">lane</span> <span class="o">/</span> <span class="n">numberOfCcolumns</span><span class="p">)</span> <span class="o">*</span> <span class="mi">512</span><span class="p">)</span> <span class="o">-</span> <span class="mi">64</span>
        <span class="n">yPos</span> <span class="o">=</span> <span class="mi">192</span>

        <span class="n">hsBits</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="s2">&quot;HitSound&quot;</span> <span class="ow">in</span> <span class="n">hitObject</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hitObject</span><span class="p">[</span><span class="s2">&quot;HitSound&quot;</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">hitSounds</span> <span class="o">=</span> <span class="n">hitObject</span><span class="p">[</span><span class="s2">&quot;HitSound&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">hitSound</span> <span class="ow">in</span> <span class="n">hitSounds</span><span class="p">:</span>
                <span class="n">hsBits</span> <span class="o">+=</span> <span class="n">hitSoundsDict</span><span class="p">[</span><span class="n">hitSound</span><span class="p">]</span>

        <span class="k">if</span> <span class="s2">&quot;EndTime&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">hitObject</span><span class="p">:</span>  <span class="c1"># normal note</span>
            <span class="n">line</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{xPos}</span><span class="s2">,</span><span class="si">{yPos}</span><span class="s2">,</span><span class="si">{startTime}</span><span class="s2">,1,</span><span class="si">{hsBits}</span><span class="s2">,0:0:0:0:&quot;</span>

        <span class="k">else</span><span class="p">:</span>  <span class="c1"># long note</span>
            <span class="n">endTime</span> <span class="o">=</span> <span class="n">hitObject</span><span class="p">[</span><span class="s2">&quot;EndTime&quot;</span><span class="p">]</span>
            <span class="n">line</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{xPos}</span><span class="s2">,</span><span class="si">{yPos}</span><span class="s2">,</span><span class="si">{startTime}</span><span class="s2">,128,</span><span class="si">{hsBits}</span><span class="s2">,</span><span class="si">{endTime}</span><span class="s2">:0:0:0:0:&quot;</span>

        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-31'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-31'>#</a>
      </div>
      <p>Converts a .qua beatmap file to a .osu beatmap file</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">convertQua2Osu</span><span class="p">(</span><span class="n">fileContent</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-32'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-32'>#</a>
      </div>
      <p>All parts are split into different sections, defined by the .osu structure
| Section      | Content                                |
|--------------|----------------------------------------|
| General      | Contains general settings              |
| Editor       | Contains editor related settings       |
| Metadata     | Contains the metadata of the beatmap   |
| Difficulty   | Contains difficulty related settings   |
| Events       | Contains the background file name      |
| TimingPoints | Contains the timing                    |
| HitObjects   | Contains the hit objects (notes)       |</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">qua</span> <span class="o">=</span> <span class="n">loadQua</span><span class="p">(</span><span class="n">fileContent</span><span class="p">)</span>

    <span class="n">osu</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
        <span class="s2">&quot;// This map was converted using qua2osu&quot;</span><span class="p">,</span>
        <span class="s2">&quot;osu file format v14&quot;</span><span class="p">,</span>
        <span class="n">convertGeneral</span><span class="p">(</span><span class="n">qua</span><span class="p">,</span> <span class="n">options</span><span class="p">),</span>
        <span class="n">convertEditor</span><span class="p">(),</span>
        <span class="n">convertMetadata</span><span class="p">(</span><span class="n">qua</span><span class="p">),</span>
        <span class="n">convertDifficulty</span><span class="p">(</span><span class="n">qua</span><span class="p">,</span> <span class="n">options</span><span class="p">),</span>
        <span class="n">convertEvents</span><span class="p">(</span><span class="n">qua</span><span class="p">),</span>
        <span class="n">convertTimingPoints</span><span class="p">(</span><span class="n">qua</span><span class="p">,</span> <span class="n">options</span><span class="p">),</span>
        <span class="n">convertHitObjects</span><span class="p">(</span><span class="n">qua</span><span class="p">)</span>
    <span class="p">])</span>

    <span class="k">return</span> <span class="n">osu</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-33'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-33'>#</a>
      </div>
      <p>Converts a whole .qp mapset to a .osz mapset</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">convertMapset</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">outputFolder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-34'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-34'>#</a>
      </div>
      <p>Moves all files to a new directory and converts all .qua files to .osu files</p>
<p>Options are built up as following:
    options = {
        &ldquo;od&rdquo;: int,
        &ldquo;hp&rdquo;: int,
        &ldquo;hitSoundVolume&rdquo;: int,
        &ldquo;sampleSet&rdquo;: [&ldquo;Soft&rdquo;,&rdquo;Normal&rdquo;,&rdquo;Drum&rdquo;]
    }</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-35'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-35'>#</a>
      </div>
      <p>Prefixing with q_ to prevent osu from showing the wrong preview
backgrounds because it takes the folder number to
choose the background for whatever reason</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">folderName</span> <span class="o">=</span> <span class="s2">&quot;q_&quot;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">outputPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outputFolder</span><span class="p">,</span> <span class="n">folderName</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;od&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="s2">&quot;hp&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="s2">&quot;hitSoundVolume&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
            <span class="s2">&quot;sampleSet&quot;</span><span class="p">:</span> <span class="s2">&quot;Soft&quot;</span>
        <span class="p">}</span>

    <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">oldDir</span><span class="p">:</span>
        <span class="n">oldDir</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">outputPath</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">outputPath</span><span class="p">):</span>
        <span class="n">filePath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outputPath</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.qua&quot;</span><span class="p">):</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">openedFile</span><span class="p">:</span>
                <span class="n">fileContent</span> <span class="o">=</span> <span class="n">openedFile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                <span class="n">osu</span> <span class="o">=</span> <span class="n">convertQua2Osu</span><span class="p">(</span><span class="n">fileContent</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.qua&quot;</span><span class="p">,</span> <span class="s2">&quot;.osu&quot;</span><span class="p">),</span> <span class="s2">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">newFile</span><span class="p">:</span>
                    <span class="n">newFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">osu</span><span class="p">)</span>

            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">outputPath</span> <span class="o">+</span> <span class="s2">&quot;.osz&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">newDir</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">outputPath</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                <span class="n">newDir</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">),</span> <span class="n">file</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-36'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-36'>#</a>
      </div>
      <p>Runs a basic conversion of the samples folder for testing</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">main</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-37'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-37'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">inputPath</span> <span class="o">=</span> <span class="s2">&quot;samples&quot;</span>
    <span class="n">outputPath</span> <span class="o">=</span> <span class="s2">&quot;output&quot;</span>
    <span class="n">qpFilesInInputDir</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">inputPath</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">inputPath</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.qp&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">)):</span>
            <span class="n">qpFilesInInputDir</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

    <span class="n">numberOfQpFiles</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">qpFilesInInputDir</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">numberOfQpFiles</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No mapsets found in &quot;</span> <span class="o">+</span> <span class="n">inputPath</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">qpFilesInInputDir</span><span class="p">:</span>
            <span class="n">filePath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">inputPath</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Converting </span><span class="si">{filePath}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">convertMapset</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="n">outputPath</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">timeElapsed</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Finished converting all mapsets, total time elapsed: </span><span class="si">{timeElapsed}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
